<!DOCTYPE html>
<html>
	<head>
		<title>Bookmarks</title>
		<meta charset="UTF-8"/>
		<meta http-equiv="Expires" content="0"/>
		<meta http-equiv="pragma" content="no-cache"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<script src="./javascript/require.js"></script>
		<link rel="stylesheet" href="./css/bookmarks.css"/>
	</head>
	<body>
		<div id="editorToolbar" class="tree">
			<ul>
				<li>
					<input type="checkbox" id="c5" />
					<label class="tree_label" for="c5">Level 0</label>
					<ul>
						<li>
							<input type="checkbox" id="c6" />
							<label for="c6" class="tree_label">Level 1</label>
							<ul>
								<li><span class="tree_label">Level 2</span></li>
							</ul>
						</li>
						<li>
							<input type="checkbox" id="c7" />
							<label for="c7" class="tree_label">Level 1</label>
							<ul>
								<li><span class="tree_label">Level 2</span></li>
								<li>
									<input type="checkbox" id="c8" />
									<label for="c8" class="tree_label">Level 2</label>
									<ul>
										<li><span class="tree_label">Level 3</span></li>
									</ul>
								</li>
							</ul>
						</li>
					</ul>
				</li>
			</ul>
		</div>
		<div id="bookmarks">
			
		</div>
		<script>
			require.config({
				baseUrl: './javascript',
				waitSeconds: 0
			});
			
			document.addEventListener('DOMContentLoaded', function() {				
				/*document.getElementById('test-bookmarks').addEventListener("click", function() {
					var meta = event.target;
					var isCaret = meta.parentElement && meta.parentElement.tagName === 'LABEL' && meta.parentElement.children[0].checked;
					var isBookmark = !isCaret && meta.parentElement && meta.parentElement.tagName === 'LI' && meta.tagName === 'SPAN';
					//debugger;
					
					
					if (isCaret) {
						//meta.parentElement.querySelector(".nested").classList.toggle("active");
						meta.parentElement.nextElementSibling.nextElementSibling.classList.toggle('active');
						meta.parentElement.children[1].classList.toggle("caret-down");
						event.stopPropagation();
						window.event.cancelBubble = true;
					} else if (isBookmark) {
						//open bookmark
					}
				});*/
				
				
				require(['bookmarks'], function(bookmarks) {
					var callMe = function(json) {
						var bookmarksData = {},
							parsed = JSON.parse(json);
						//debugger;
						bookmarksData.configData = parsed;
						bookmarksData.destination = document.getElementById('bookmarks');
						bookmarks.init(bookmarksData);
					};
					
					var request = new XMLHttpRequest();
					request.overrideMimeType('application/json');
					request.open('GET', 'http://127.0.0.1:8080/bookmarks.json', true);
					
					request.onreadystatechange = function() {
						if (request.readyState === 4 && request.status === 200) {
							callMe(request.responseText);
						}
					};
					
					request.send(null);
				});
			});
		</script>
	</body>
</html>